proc print data=hospital; run;

data hospital1;
set hospital;
region1=0; region2=0;region3=0;
if region=1 then region1=1;
if region=2 then region2=1;
if region=3 then region3=1;
output;
run;
proc print data=hospital1; run;

proc reg data=hospital1;
model risk=stay age culture xray beds school region1 region2 region3 census nurses facilities;
plot (risk student. rstudent.)*p. r.*nqq.;
output out=hospital2 rstudent=dr p=riskhat;
run;

proc print data=hospital2;
where dr>3;
run;

proc reg data=hospital1;
model risk=stay age culture xray beds school region1 region2 region3 census nurses facilities/partial;
where NOT(id =53);
plot (student. rstudent.)*p. r.*nqq. student.*(beds census);
run;

data hospital3;
set hospital1;
stayage=stay*age;
staynurses=stay*nurses;
cs=culture*stay;
cf=culture*facilities;
cx=culture*xray;
sf=stay*facilities;
sx=stay*xray;
fx=facilities*xray;
run;

proc reg data=hospital3;
model risk=stay age culture xray beds school region1 region2 region3 census nurses facilities
   stayage staynurses/selection=stepwise;
where NOT(id =53);
run;

proc reg data=hospital3;
model risk=culture stay facilities xray cs cf cx sf sx fx;
where NOT(id =53);
test  cs,cf,cx,sf,sx,fx;
run;

proc reg data=hospital3;
model risk=culture stay facilities xray cs cf cx sf sx fx /selection=stepwise;
where NOT(id =53);
test  cs,cf,cx,sf,sx,fx;
run;

proc reg data=hospital3;
model risk=culture stay facilities xray cs cf/VIF;
where NOT(id =53);
run;
